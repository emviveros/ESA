#N canvas 159 142 918 625 10;
#X declare -lib ofelia;
#X declare -path ./scripts;
#X declare -path ../;
#X obj 42 32 inlet;
#X text 11 14 entradaMIDI_notein;
#X obj 92 67 inlet;
#X obj 303 29 inlet;
#X obj 359 63 inlet;
#X text 61 49 entradaMIDI_ctlin;
#X text 267 11 Sampler->Sequencer;
#X text 337 48 Synth->Sequencer;
#X obj 87 438 outlet;
#X text 55 458 Sequencer->Sampler;
#X obj 227 438 outlet;
#X obj 602 37 inlet;
#X text 560 19 sequencer timestamp;
#X msg 1164 171 2;
#X msg 1196 171 4;
#X msg 1224 171 8;
#X msg 1256 171 16;
#X msg 1284 171 32;
#X msg 1316 171 64;
#X msg 1344 171 128;
#X msg 1376 171 256;
#X msg 1404 171 512;
#X obj 1176 201 s seq_resolution;
#X msg 1434 171 1024;
#X msg 1470 171 2048;
#X text 1479 156 10240;
#X text 1442 156 5200;
#X obj 1300 232 s debug_seq_timestamp_dsp_off;
#X obj 1300 215 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1
0 1;
#X text 1408 156 2560;
#X text 1373 156 1280;
#X text 1346 156 640;
#X text 1316 156 320;
#X text 1287 156 160;
#X text 1261 156 80;
#X text 1225 156 40;
#X text 1196 156 20;
#X text 1168 156 10;
#N canvas 295 391 845 276 estrutura_de_dados_sequencer 0;
#N canvas 657 437 450 300 \$0-MIDIctlin 0;
#X obj 46 135 struct \$0-MIDIctlin float canalMIDI float CC float valor
;
#X restore 37 166 pd \$0-MIDIctlin;
#N canvas 563 291 450 300 \$0-dados 0;
#X restore 37 204 pd \$0-dados;
#N canvas 657 437 450 300 \$0-MIDInotein 0;
#X obj 75 113 struct \$0-MIDInotein float pitch float velocity;
#X restore 37 146 pd \$0-MIDInotein;
#N canvas 257 340 450 300 \$0-Synth_parametros 0;
#X obj 55 112 struct \$0-Synth_parametros float timbre float volume
;
#X restore 37 72 pd \$0-Synth_parametros;
#N canvas 257 340 450 300 \$0-Sampler_parametros 0;
#X obj 55 112 struct \$0-Sampler_parametros float timbre float volume
;
#X restore 37 92 pd \$0-Sampler_parametros;
#N canvas 267 296 450 300 \$0-estrutura_seq 0;
#X obj 18 84 struct \$0-estrutura_seq array paramatros_synth \$0-Synth_parametros
array parametros_sampler \$0-Sampler_parametros array FXs \$0-Efeitos
, f 67;
#X restore 37 35 pd \$0-estrutura_seq;
#X text 165 34 <- estrutura de dados do sequenciador;
#X text 141 145 referente as entradas de notas MIDI;
#X text 132 168 dados de faders e knobs;
#X text 176 73 parâmetros referentes ao Synth;
#X text 186 94 parâmetros referentes ao Sampler;
#N canvas 257 340 450 300 \$0-Efeitos 0;
#X obj 55 112 struct \$0-Efeitos float nome_fx float param_1 float
param_2 float param_3;
#X restore 37 112 pd \$0-Efeitos;
#X text 121 114 parâmetros e controles da cadeia de efeitos;
#X text 489 27 INCOMPLETO;
#X text 499 45 VOU TENTAR IR POR ESTE CAMINHO DEPOIS PARA OTIMIZAÇÃO
DO USO DE CPU CASO NECESSÁRIO, f 42;
#X obj 447 87 else/openfile https://forum.pdpatchrepo.info/topic/12059/array-text-pointer/3
-h;
#X restore 1299 260 pd estrutura_de_dados_sequencer;
#X obj 778 174 declare -lib ofelia;
#X obj 754 210 declare -path ./scripts;
#X obj 97 233 else/initmess read -c sequencer.lua;
#X obj 367 438 outlet;
#X text 335 458 Sequencer->Efeitos;
#X obj 416 100 inlet;
#X text 394 82 FX->Sequencer;
#X msg 456 101 pitch-shift on;
#X msg 457 120 pitch-shift off;
#X obj 302 523 v pad_n;
#X text 375 212 PARA entrar armazenar uma mensagem no Sequencer é
necessário:;
#X text 385 241 - DSP on;
#X text 385 255 - ter algum pad acionado ([v pad_n] = -1 significa
que não tem nenhum acionado);
#X text 385 279 - um processador ativado (Sampler/Synth/FX);
#X text 1164 111 Para calcular o tamanho em dependência da resolução
dimensão = resolução * (quantum +1), f 51;
#X obj 99 523 v seq_resolution;
#X obj 99 503 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X floatatom 99 544 5 0 0 0 - - -;
#X obj 211 503 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 211 523 v padSeq_dim;
#X floatatom 211 544 5 0 0 0 - - -;
#X obj 33 504 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X floatatom 33 545 5 0 0 0 - - -;
#X obj 33 524 v quantum;
#N canvas 49 350 646 387 entradaMIDI 0;
#X obj 63 36 inlet;
#X obj 315 36 inlet;
#X msg 345 71 \$2 \$1 \$3;
#X obj 95 206 list prepend notein;
#X obj 345 205 list prepend ctlin;
#X obj 95 107 v pad_n;
#X obj 345 124 v pad_n;
#X obj 510 36 inlet;
#X obj 150 296 list trim;
#X obj 140 347 outlet;
#X text 23 18 entradaMIDI_notein;
#X text 276 18 entradaMIDI_ctlin;
#X text 469 15 índice de padSeq (0-n);
#X text 168 83 formata os dados MIDI para processamento pelo sequencer
, f 28;
#X obj 95 82 t b l, f 9;
#X obj 345 104 t b l, f 10;
#X obj 95 179 list prepend;
#X obj 345 179 list prepend;
#X obj 530 127 t f f;
#X obj 95 134 list append;
#X obj 345 146 list append;
#X text 127 224 'notein' <idx><pad_n><<notein>>;
#X text 369 225 'ctlin' <idx><pad_n><<ctlin>>;
#X connect 0 0 14 0;
#X connect 1 0 2 0;
#X connect 2 0 15 0;
#X connect 3 0 8 0;
#X connect 4 0 8 0;
#X connect 5 0 19 0;
#X connect 6 0 20 0;
#X connect 7 0 18 0;
#X connect 8 0 9 0;
#X connect 14 0 5 0;
#X connect 14 1 19 1;
#X connect 15 0 6 0;
#X connect 15 1 20 1;
#X connect 16 0 3 0;
#X connect 17 0 4 0;
#X connect 18 0 16 1;
#X connect 18 1 17 1;
#X connect 19 0 16 0;
#X connect 20 0 17 0;
#X restore 66 110 pd entradaMIDI;
#N canvas 207 374 622 313 processadores 0;
#X obj 53 44 inlet;
#X obj 238 44 inlet;
#X text 17 26 Sampler->Sequencer;
#X text 216 26 Synth->Sequencer;
#X obj 388 44 inlet;
#X text 366 26 FX->Sequencer;
#X obj 71 97 list prepend sampler;
#X obj 256 97 list prepend synth;
#X obj 406 97 list prepend efeito;
#X obj 256 203 list trim;
#X obj 266 244 outlet;
#X connect 0 0 6 0;
#X connect 1 0 7 0;
#X connect 4 0 8 0;
#X connect 6 0 9 0;
#X connect 7 0 9 0;
#X connect 8 0 9 0;
#X connect 9 0 10 0;
#X restore 333 136 pd processadores;
#N canvas 331 339 514 332 gravar-reproduzir 0;
#X obj 66 40 inlet;
#X obj 331 44 inlet;
#X obj 53 265 outlet;
#X obj 221 265 outlet;
#X obj 96 149 else/router, f 23;
#X obj 231 131 + 1;
#N canvas 484 186 511 358 calculo_índice 0;
#X obj 49 45 inlet;
#X obj 111 299 outlet;
#X obj 79 144 *;
#X obj 121 170 +;
#X obj 79 101 unpack f f;
#X text 192 123 <-- A2 em [pd sequencer_timestamp];
#X obj 94 123 r seq_resolution;
#X text 148 174 índice da tabela de automação;
#X text 173 41 Cáculo do índice da tabela a partir da fase;
#N canvas 426 142 450 514 tamanhos_da_tabela_por_resolução 0;
#X msg 129 42 2;
#X msg 139 84 4;
#X msg 143 120 8;
#X msg 146 156 16;
#X msg 149 191 32;
#X msg 151 227 64;
#X msg 152 263 128;
#X msg 153 298 256;
#X msg 152 335 512;
#X obj 88 440 s seq_resolution;
#X msg 151 369 1024;
#X msg 149 405 2048;
#X text 162 390 10240;
#X text 163 354 5200;
#X text 160 320 2560;
#X text 154 283 1280;
#X text 158 248 640;
#X text 155 212 320;
#X text 152 176 160;
#X text 151 141 80;
#X text 144 105 40;
#X text 139 69 20;
#X text 133 27 10;
#X text 64 42 resolução=;
#X text 151 26 pontos na tabela de automação;
#X connect 0 0 9 0;
#X connect 1 0 9 0;
#X connect 2 0 9 0;
#X connect 3 0 9 0;
#X connect 4 0 9 0;
#X connect 5 0 9 0;
#X connect 6 0 9 0;
#X connect 7 0 9 0;
#X connect 8 0 9 0;
#X connect 10 0 9 0;
#X connect 11 0 9 0;
#X restore 260 245 pd tamanhos_da_tabela_por_resolução;
#X connect 0 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X connect 4 0 2 0;
#X connect 4 1 3 1;
#X connect 6 0 2 1;
#X restore 96 78 pd calculo_índice;
#X obj 294 184 v pad_n;
#X obj 231 168 t f b;
#X obj 231 225 list prepend play;
#X text 31 23 sequencer timestamp;
#X text 320 24 controle;
#X text 272 115 0 -> grava;
#X text 272 127 1 -> reproduz;
#X obj 231 204 list append;
#X text 275 244 'play' <idx> <pad_n>;
#X connect 0 0 6 0;
#X connect 1 0 5 0;
#X connect 4 0 2 0;
#X connect 4 1 8 0;
#X connect 5 0 4 1;
#X connect 6 0 4 0;
#X connect 7 0 14 1;
#X connect 8 0 14 0;
#X connect 8 1 7 0;
#X connect 9 0 3 0;
#X connect 14 0 9 0;
#X restore 602 91 pd gravar-reproduzir;
#X obj 719 56 vradio 15 1 0 2 empty empty empty 0 -8 0 10 -262144 -1
-1 0;
#X text 737 58 gravar;
#X text 737 73 reproduzir;
#X obj 706 35 else/initmess 0;
#X obj 476 353 teste_sequenciador_lua;
#X obj 790 192 declare -path ../;
#X obj 169 369 ofelia d -c13 \$0-seq;
#X text 195 458 Sequencer->Synth;
#X obj 230 314 r teste_luaScriptSeq;
#X obj 602 134 s \$0-timestamp_seq_gravação;
#X obj 141 81 r \$0-timestamp_seq_gravação;
#X obj 719 114 s \$0-timestamp_seq_reprodução;
#X obj 239 335 r \$0-timestamp_seq_reprodução;
#X obj 56 152 s \$0-entradasMIDI_seq;
#X obj 194 271 r \$0-entradasMIDI_seq;
#X obj 323 177 s \$0-processadores_seq;
#X obj 213 292 r \$0-processadores_seq;
#N canvas 0 22 623 300 referências 0;
#X obj 86 42 else/openfile https://forum.pdpatchrepo.info/topic/13230/recording-control-domain-real-time
-h;
#X obj 84 125 else/openfile https://forum.pdpatchrepo.info/topic/13206/how-to-add-swing-to-a-sequencer
-h;
#X obj 88 85 else/openfile https://forum.pdpatchrepo.info/topic/12059/array-text-pointer/3
-h;
#X restore 1256 35 pd referências;
#X obj 1142 319 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 1142 339 ofelia f \; t = ofTable(4 \, ofTable('a' \, 'b') \,
98) \; return ipairs;
#N canvas 442 168 762 428 saídas_modo_debug 0;
#X obj 37 79 inlet;
#X obj 37 364 outlet;
#X obj 37 342 list trim;
#X obj 111 199 list trim;
#X obj 111 221 print saída_Sampler;
#X obj 311 199 list trim;
#X obj 523 199 list trim;
#X obj 311 221 print saída_Synth;
#X obj 523 221 print saída_Efeitos;
#X msg 554 153 1;
#X msg 585 153 2;
#X obj 37 169 else/router 2 1;
#X obj 237 79 inlet;
#X obj 237 364 outlet;
#X obj 237 342 list trim;
#X obj 237 169 else/router 2 1;
#X obj 447 79 inlet;
#X obj 447 364 outlet;
#X obj 447 342 list trim;
#X obj 447 169 else/router 2 1;
#X obj 554 127 sel 0 1;
#X obj 534 102 r ofelia_outs_debug_mode;
#X text 27 21 Roteia saídas de [ofelia d -c13 \$0-seq];
#X text 561 272 quando modo debug de saídas ativado \, interrompe
fluxo para fora e os dados são exibidos somente no console do Pd.
, f 29;
#X connect 0 0 11 0;
#X connect 2 0 1 0;
#X connect 3 0 4 0;
#X connect 5 0 7 0;
#X connect 6 0 8 0;
#X connect 9 0 11 1;
#X connect 9 0 15 1;
#X connect 9 0 19 1;
#X connect 10 0 11 1;
#X connect 10 0 15 1;
#X connect 10 0 19 1;
#X connect 11 0 2 0;
#X connect 11 1 3 0;
#X connect 12 0 15 0;
#X connect 14 0 13 0;
#X connect 15 0 14 0;
#X connect 15 1 5 0;
#X connect 16 0 19 0;
#X connect 18 0 17 0;
#X connect 19 0 18 0;
#X connect 19 1 6 0;
#X connect 20 0 9 0;
#X connect 20 1 10 0;
#X connect 21 0 20 0;
#X restore 169 387 pd saídas_modo_debug;
#X obj 302 503 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X floatatom 302 544 5 0 0 0 - - -;
#X obj 22 190 else/note 425 18 Menlo empty 0 0 0 0 0 255 255 255 0
0 esa_sequencer;
#N canvas 166 157 782 307 teste_ofelia_entradas 0;
#X text 677 229 comment;
#X obj 396 188 print outlet_0;
#X obj 538 192 print outlet_1;
#X obj 394 50 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 407 87 ofelia d -c12 \; local out=ofOutlet(this) \; function
M.bang() \; for i=1 \, 10 do \; out:outletList(0 \, ofTable(i+10))
\; end \; out:outletList(1 \, ofTable('end')) \; end \;;
#X connect 3 0 4 0;
#X connect 4 0 1 0;
#X connect 4 1 2 0;
#X restore 711 313 pd teste_ofelia_entradas;
#X obj 63 334 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X msg 63 353 logs \$1;
#X obj 50 289 else/initmess 0;
#X text 19 370 liga/desl msgs console;
#X obj 50 310 pipe 1000;
#X connect 0 0 63 0;
#X connect 2 0 63 1;
#X connect 3 0 64 0;
#X connect 4 0 64 1;
#X connect 11 0 65 0;
#X connect 13 0 22 0;
#X connect 14 0 22 0;
#X connect 15 0 22 0;
#X connect 16 0 22 0;
#X connect 17 0 22 0;
#X connect 18 0 22 0;
#X connect 19 0 22 0;
#X connect 20 0 22 0;
#X connect 21 0 22 0;
#X connect 23 0 22 0;
#X connect 24 0 22 0;
#X connect 28 0 27 0;
#X connect 41 0 72 0;
#X connect 44 0 64 2;
#X connect 46 0 64 2;
#X connect 47 0 64 2;
#X connect 48 0 88 0;
#X connect 54 0 56 0;
#X connect 55 0 54 0;
#X connect 57 0 58 0;
#X connect 58 0 59 0;
#X connect 60 0 62 0;
#X connect 62 0 61 0;
#X connect 63 0 79 0;
#X connect 64 0 81 0;
#X connect 65 0 75 0;
#X connect 65 1 77 0;
#X connect 66 0 65 1;
#X connect 69 0 66 0;
#X connect 72 0 86 0;
#X connect 72 1 86 1;
#X connect 72 2 86 2;
#X connect 74 0 72 0;
#X connect 76 0 63 2;
#X connect 78 0 72 0;
#X connect 80 0 72 0;
#X connect 82 0 72 0;
#X connect 84 0 85 0;
#X connect 86 0 8 0;
#X connect 86 1 10 0;
#X connect 86 2 42 0;
#X connect 87 0 48 0;
#X connect 91 0 92 0;
#X connect 92 0 72 0;
#X connect 93 0 95 0;
#X connect 95 0 91 0;
